#! /usr/bin/vvp
:ivl_version "12.0 (stable)";
:ivl_delay_selection "TYPICAL";
:vpi_time_precision - 12;
:vpi_module "/usr/lib/x86_64-linux-gnu/ivl/system.vpi";
:vpi_module "/usr/lib/x86_64-linux-gnu/ivl/vhdl_sys.vpi";
:vpi_module "/usr/lib/x86_64-linux-gnu/ivl/vhdl_textio.vpi";
:vpi_module "/usr/lib/x86_64-linux-gnu/ivl/v2005_math.vpi";
:vpi_module "/usr/lib/x86_64-linux-gnu/ivl/va_math.vpi";
S_0x5e1017187180 .scope module, "Instruction_Memory_tb" "Instruction_Memory_tb" 2 4;
 .timescale -9 -12;
v0x5e10171c2740_0 .var "Address", 31 0;
v0x5e10171c2800_0 .net "ReadData", 31 0, L_0x5e10171d3490;  1 drivers
v0x5e10171c28d0_0 .var "data_0", 31 0;
v0x5e10171c29a0_0 .var "data_1", 31 0;
v0x5e10171c2a80_0 .var "data_2", 31 0;
v0x5e10171c2b60_0 .var "data_3", 31 0;
v0x5e10171c2c40_0 .var "rapid_data_0", 31 0;
v0x5e10171c2d20_0 .var "rapid_data_1", 31 0;
v0x5e10171c2e00_0 .var "rapid_data_2", 31 0;
v0x5e10171c2ee0_0 .var "rst", 0 0;
v0x5e10171c2f80_0 .var/i "test_count", 31 0;
v0x5e10171c3040_0 .var "test_passed", 0 0;
S_0x5e1017187310 .scope module, "uut" "Instruction_Memory" 2 24, 3 1 0, S_0x5e1017187180;
 .timescale 0 0;
    .port_info 0 /INPUT 1 "rst";
    .port_info 1 /INPUT 32 "Address";
    .port_info 2 /OUTPUT 32 "ReadData";
L_0x737eae351018 .functor BUFT 1, C4<0>, C4<0>, C4<0>, C4<0>;
L_0x5e10171c3130 .functor XNOR 1, v0x5e10171c2ee0_0, L_0x737eae351018, C4<0>, C4<0>;
v0x5e1017187540_0 .net "Address", 31 0, v0x5e10171c2740_0;  1 drivers
v0x5e10171c1ff0_0 .net "ReadData", 31 0, L_0x5e10171d3490;  alias, 1 drivers
v0x5e10171c20d0_0 .net/2u *"_ivl_0", 0 0, L_0x737eae351018;  1 drivers
v0x5e10171c2190_0 .net *"_ivl_2", 0 0, L_0x5e10171c3130;  1 drivers
L_0x737eae351060 .functor BUFT 1, C4<00000000000000000000000000000000>, C4<0>, C4<0>, C4<0>;
v0x5e10171c2250_0 .net/2u *"_ivl_4", 31 0, L_0x737eae351060;  1 drivers
v0x5e10171c2380_0 .net *"_ivl_6", 31 0, L_0x5e10171d3250;  1 drivers
v0x5e10171c2460_0 .net *"_ivl_9", 29 0, L_0x5e10171d3350;  1 drivers
v0x5e10171c2540 .array "mem", 0 1023, 31 0;
v0x5e10171c2600_0 .net "rst", 0 0, v0x5e10171c2ee0_0;  1 drivers
L_0x5e10171d3250 .array/port v0x5e10171c2540, L_0x5e10171d3350;
L_0x5e10171d3350 .part v0x5e10171c2740_0, 2, 30;
L_0x5e10171d3490 .functor MUXZ 32, L_0x5e10171d3250, L_0x737eae351060, L_0x5e10171c3130, C4<>;
    .scope S_0x5e1017187310;
T_0 ;
    %vpi_call 3 9 "$readmemh", "memfile.hex", v0x5e10171c2540 {0 0 0};
    %end;
    .thread T_0;
    .scope S_0x5e1017187180;
T_1 ;
    %vpi_call 2 32 "$dumpfile", "Instruction_Memory_tb.vcd" {0 0 0};
    %vpi_call 2 33 "$dumpvars", 32'sb00000000000000000000000000000000, S_0x5e1017187180 {0 0 0};
    %end;
    .thread T_1;
    .scope S_0x5e1017187180;
T_2 ;
    %vpi_call 2 38 "$display", "=== Instruction Memory Module Testbench ===" {0 0 0};
    %vpi_call 2 39 "$display", "Time\011Rst\011Address\011\011ReadData\011Test Description" {0 0 0};
    %pushi/vec4 1, 0, 1;
    %store/vec4 v0x5e10171c3040_0, 0, 1;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v0x5e10171c2f80_0, 0, 32;
    %delay 10000, 0;
    %vpi_call 2 48 "$display", "\012--- Test 1: Reset Functionality ---" {0 0 0};
    %pushi/vec4 0, 0, 1;
    %store/vec4 v0x5e10171c2ee0_0, 0, 1;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v0x5e10171c2740_0, 0, 32;
    %delay 10000, 0;
    %vpi_call 2 52 "$display", "%0t\011%b\011%08x\011%08x\011Reset=0", $time, v0x5e10171c2ee0_0, v0x5e10171c2740_0, v0x5e10171c2800_0 {0 0 0};
    %load/vec4 v0x5e10171c2800_0;
    %cmpi/e 0, 0, 32;
    %jmp/0xz  T_2.0, 4;
    %vpi_call 2 55 "$display", "\342\234\223 PASS: Reset properly disables memory output" {0 0 0};
    %jmp T_2.1;
T_2.0 ;
    %vpi_call 2 57 "$display", "\342\234\227 FAIL: Reset should disable output, got %08x", v0x5e10171c2800_0 {0 0 0};
    %pushi/vec4 0, 0, 1;
    %store/vec4 v0x5e10171c3040_0, 0, 1;
T_2.1 ;
    %load/vec4 v0x5e10171c2f80_0;
    %addi 1, 0, 32;
    %store/vec4 v0x5e10171c2f80_0, 0, 32;
    %vpi_call 2 63 "$display", "\012--- Test 2: Normal Memory Access ---" {0 0 0};
    %pushi/vec4 1, 0, 1;
    %store/vec4 v0x5e10171c2ee0_0, 0, 1;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v0x5e10171c2740_0, 0, 32;
    %delay 10000, 0;
    %vpi_call 2 67 "$display", "%0t\011%b\011%08x\011%08x\011Addr=0", $time, v0x5e10171c2ee0_0, v0x5e10171c2740_0, v0x5e10171c2800_0 {0 0 0};
    %load/vec4 v0x5e10171c2800_0;
    %cmpi/ne 0, 0, 32;
    %jmp/0xz  T_2.2, 4;
    %vpi_call 2 71 "$display", "\342\234\223 PASS: Memory read enabled when rst=1, data=%08x", v0x5e10171c2800_0 {0 0 0};
    %jmp T_2.3;
T_2.2 ;
    %vpi_call 2 73 "$display", "\342\232\240 INFO: Memory location 0 contains 0 (might be correct)" {0 0 0};
T_2.3 ;
    %load/vec4 v0x5e10171c2f80_0;
    %addi 1, 0, 32;
    %store/vec4 v0x5e10171c2f80_0, 0, 32;
    %vpi_call 2 78 "$display", "\012--- Test 3: Word-Aligned Address Access ---" {0 0 0};
    %pushi/vec4 4, 0, 32;
    %store/vec4 v0x5e10171c2740_0, 0, 32;
    %delay 10000, 0;
    %vpi_call 2 83 "$display", "%0t\011%b\011%08x\011%08x\011Addr=4", $time, v0x5e10171c2ee0_0, v0x5e10171c2740_0, v0x5e10171c2800_0 {0 0 0};
    %pushi/vec4 8, 0, 32;
    %store/vec4 v0x5e10171c2740_0, 0, 32;
    %delay 10000, 0;
    %vpi_call 2 88 "$display", "%0t\011%b\011%08x\011%08x\011Addr=8", $time, v0x5e10171c2ee0_0, v0x5e10171c2740_0, v0x5e10171c2800_0 {0 0 0};
    %pushi/vec4 12, 0, 32;
    %store/vec4 v0x5e10171c2740_0, 0, 32;
    %delay 10000, 0;
    %vpi_call 2 93 "$display", "%0t\011%b\011%08x\011%08x\011Addr=12", $time, v0x5e10171c2ee0_0, v0x5e10171c2740_0, v0x5e10171c2800_0 {0 0 0};
    %vpi_call 2 95 "$display", "\342\234\223 INFO: Word-aligned addresses tested (mem uses Address[31:2])" {0 0 0};
    %load/vec4 v0x5e10171c2f80_0;
    %addi 1, 0, 32;
    %store/vec4 v0x5e10171c2f80_0, 0, 32;
    %vpi_call 2 99 "$display", "\012--- Test 4: Non-Word-Aligned Address Behavior ---" {0 0 0};
    %pushi/vec4 1, 0, 32;
    %store/vec4 v0x5e10171c2740_0, 0, 32;
    %delay 10000, 0;
    %load/vec4 v0x5e10171c2800_0;
    %store/vec4 v0x5e10171c29a0_0, 0, 32;
    %vpi_call 2 104 "$display", "%0t\011%b\011%08x\011%08x\011Addr=1", $time, v0x5e10171c2ee0_0, v0x5e10171c2740_0, v0x5e10171c2800_0 {0 0 0};
    %pushi/vec4 2, 0, 32;
    %store/vec4 v0x5e10171c2740_0, 0, 32;
    %delay 10000, 0;
    %load/vec4 v0x5e10171c2800_0;
    %store/vec4 v0x5e10171c2a80_0, 0, 32;
    %vpi_call 2 109 "$display", "%0t\011%b\011%08x\011%08x\011Addr=2", $time, v0x5e10171c2ee0_0, v0x5e10171c2740_0, v0x5e10171c2800_0 {0 0 0};
    %pushi/vec4 3, 0, 32;
    %store/vec4 v0x5e10171c2740_0, 0, 32;
    %delay 10000, 0;
    %load/vec4 v0x5e10171c2800_0;
    %store/vec4 v0x5e10171c2b60_0, 0, 32;
    %vpi_call 2 114 "$display", "%0t\011%b\011%08x\011%08x\011Addr=3", $time, v0x5e10171c2ee0_0, v0x5e10171c2740_0, v0x5e10171c2800_0 {0 0 0};
    %pushi/vec4 0, 0, 32;
    %store/vec4 v0x5e10171c2740_0, 0, 32;
    %delay 10000, 0;
    %load/vec4 v0x5e10171c2800_0;
    %store/vec4 v0x5e10171c28d0_0, 0, 32;
    %load/vec4 v0x5e10171c28d0_0;
    %load/vec4 v0x5e10171c29a0_0;
    %cmp/e;
    %flag_get/vec4 4;
    %jmp/0 T_2.7, 4;
    %load/vec4 v0x5e10171c28d0_0;
    %load/vec4 v0x5e10171c2a80_0;
    %cmp/e;
    %flag_get/vec4 4;
    %and;
T_2.7;
    %flag_set/vec4 9;
    %flag_get/vec4 9;
    %jmp/0 T_2.6, 9;
    %load/vec4 v0x5e10171c28d0_0;
    %load/vec4 v0x5e10171c2b60_0;
    %cmp/e;
    %flag_get/vec4 4;
    %and;
T_2.6;
    %flag_set/vec4 8;
    %jmp/0xz  T_2.4, 8;
    %vpi_call 2 121 "$display", "\342\234\223 PASS: Non-word-aligned addresses correctly map to same word" {0 0 0};
    %jmp T_2.5;
T_2.4 ;
    %vpi_call 2 123 "$display", "\342\234\227 FAIL: Address alignment not working properly" {0 0 0};
    %pushi/vec4 0, 0, 1;
    %store/vec4 v0x5e10171c3040_0, 0, 1;
T_2.5 ;
    %load/vec4 v0x5e10171c2f80_0;
    %addi 1, 0, 32;
    %store/vec4 v0x5e10171c2f80_0, 0, 32;
    %vpi_call 2 129 "$display", "\012--- Test 5: Reset During Operation ---" {0 0 0};
    %pushi/vec4 8, 0, 32;
    %store/vec4 v0x5e10171c2740_0, 0, 32;
    %pushi/vec4 1, 0, 1;
    %store/vec4 v0x5e10171c2ee0_0, 0, 1;
    %delay 5000, 0;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v0x5e10171c2ee0_0, 0, 1;
    %delay 10000, 0;
    %vpi_call 2 135 "$display", "%0t\011%b\011%08x\011%08x\011Reset During Op", $time, v0x5e10171c2ee0_0, v0x5e10171c2740_0, v0x5e10171c2800_0 {0 0 0};
    %load/vec4 v0x5e10171c2800_0;
    %cmpi/e 0, 0, 32;
    %jmp/0xz  T_2.8, 4;
    %vpi_call 2 138 "$display", "\342\234\223 PASS: Reset immediately disables output" {0 0 0};
    %jmp T_2.9;
T_2.8 ;
    %vpi_call 2 140 "$display", "\342\234\227 FAIL: Reset should immediately disable output" {0 0 0};
    %pushi/vec4 0, 0, 1;
    %store/vec4 v0x5e10171c3040_0, 0, 1;
T_2.9 ;
    %load/vec4 v0x5e10171c2f80_0;
    %addi 1, 0, 32;
    %store/vec4 v0x5e10171c2f80_0, 0, 32;
    %vpi_call 2 146 "$display", "\012--- Test 6: Large Address Values ---" {0 0 0};
    %pushi/vec4 1, 0, 1;
    %store/vec4 v0x5e10171c2ee0_0, 0, 1;
    %pushi/vec4 4092, 0, 32;
    %store/vec4 v0x5e10171c2740_0, 0, 32;
    %delay 10000, 0;
    %vpi_call 2 152 "$display", "%0t\011%b\011%08x\011%08x\011Max Valid Addr", $time, v0x5e10171c2ee0_0, v0x5e10171c2740_0, v0x5e10171c2800_0 {0 0 0};
    %pushi/vec4 4096, 0, 32;
    %store/vec4 v0x5e10171c2740_0, 0, 32;
    %delay 10000, 0;
    %vpi_call 2 157 "$display", "%0t\011%b\011%08x\011%08x\011Beyond Bounds", $time, v0x5e10171c2ee0_0, v0x5e10171c2740_0, v0x5e10171c2800_0 {0 0 0};
    %vpi_call 2 159 "$display", "\342\234\223 INFO: Large address behavior tested (implementation dependent)" {0 0 0};
    %load/vec4 v0x5e10171c2f80_0;
    %addi 1, 0, 32;
    %store/vec4 v0x5e10171c2f80_0, 0, 32;
    %vpi_call 2 163 "$display", "\012--- Test 7: Rapid Address Changes ---" {0 0 0};
    %pushi/vec4 0, 0, 32;
    %store/vec4 v0x5e10171c2740_0, 0, 32;
    %delay 2000, 0;
    %load/vec4 v0x5e10171c2800_0;
    %store/vec4 v0x5e10171c2c40_0, 0, 32;
    %pushi/vec4 4, 0, 32;
    %store/vec4 v0x5e10171c2740_0, 0, 32;
    %delay 2000, 0;
    %load/vec4 v0x5e10171c2800_0;
    %store/vec4 v0x5e10171c2d20_0, 0, 32;
    %pushi/vec4 8, 0, 32;
    %store/vec4 v0x5e10171c2740_0, 0, 32;
    %delay 2000, 0;
    %load/vec4 v0x5e10171c2800_0;
    %store/vec4 v0x5e10171c2e00_0, 0, 32;
    %vpi_call 2 174 "$display", "%0t\011%b\011%08x\011%08x\011Rapid Access", $time, v0x5e10171c2ee0_0, v0x5e10171c2740_0, v0x5e10171c2800_0 {0 0 0};
    %pushi/vec4 0, 0, 32;
    %store/vec4 v0x5e10171c2740_0, 0, 32;
    %delay 1000, 0;
    %load/vec4 v0x5e10171c2800_0;
    %load/vec4 v0x5e10171c2c40_0;
    %cmp/e;
    %jmp/0xz  T_2.10, 4;
    %vpi_call 2 179 "$display", "\342\234\223 PASS: Memory responds immediately to address changes" {0 0 0};
    %jmp T_2.11;
T_2.10 ;
    %vpi_call 2 181 "$display", "\342\234\227 FAIL: Memory should respond immediately to address changes" {0 0 0};
    %pushi/vec4 0, 0, 1;
    %store/vec4 v0x5e10171c3040_0, 0, 1;
T_2.11 ;
    %load/vec4 v0x5e10171c2f80_0;
    %addi 1, 0, 32;
    %store/vec4 v0x5e10171c2f80_0, 0, 32;
    %vpi_call 2 187 "$display", "\012--- Test 8: Verify Memory File Loading ---" {0 0 0};
    %pushi/vec4 0, 0, 32;
    %store/vec4 v0x5e10171c2740_0, 0, 32;
    %delay 10000, 0;
    %vpi_call 2 191 "$display", "mem[0] (addr 0x00000000): 0x%08x", v0x5e10171c2800_0 {0 0 0};
    %pushi/vec4 4, 0, 32;
    %store/vec4 v0x5e10171c2740_0, 0, 32;
    %delay 10000, 0;
    %vpi_call 2 194 "$display", "mem[1] (addr 0x00000004): 0x%08x", v0x5e10171c2800_0 {0 0 0};
    %vpi_call 2 196 "$display", "\342\234\223 INFO: Memory file content verified" {0 0 0};
    %load/vec4 v0x5e10171c2f80_0;
    %addi 1, 0, 32;
    %store/vec4 v0x5e10171c2f80_0, 0, 32;
    %vpi_call 2 200 "$display", "\012=== Instruction_Memory Testbench Complete ===" {0 0 0};
    %load/vec4 v0x5e10171c3040_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_2.12, 8;
    %vpi_call 2 202 "$display", "\360\237\216\211 ALL TESTS PASSED! (%0d/%0d)", v0x5e10171c2f80_0, v0x5e10171c2f80_0 {0 0 0};
    %jmp T_2.13;
T_2.12 ;
    %vpi_call 2 204 "$display", "\342\235\214 SOME TESTS FAILED!" {0 0 0};
T_2.13 ;
    %delay 50000, 0;
    %vpi_call 2 208 "$finish" {0 0 0};
    %end;
    .thread T_2;
# The file index is used to find the file name in the following table.
:file_names 4;
    "N/A";
    "<interactive>";
    "Instruction_Memory_tb.v";
    "../src/Instruction_Memory.v";
